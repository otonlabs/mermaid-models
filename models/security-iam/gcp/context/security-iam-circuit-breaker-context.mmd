---
config:
  layout: elk
  elk:
    mergeEdges: true
    nodePlacementStrategy: NETWORK_SIMPLEX
    cycleBreakingStrategy: GREEDY
  c4:
    diagramMarginX: 25
    diagramMarginY: 25
---
C4Context
    title Security IAM com Circuit Breaker [GCP]

    Person(End_User, "End User", "Usuario final da plataforma")
    Person(Security_Admin, "Security Admin", "Administrador de seguranca")

    System(main_system, "Security IAM Platform", "Previne falhas em cascata com circuit breaker pattern no contexto de seguranca e gestao de identidade", $sprite="img:https://icon.icepanel.io/GCP/svg/Compute/Cloud-Run.svg")

    System_Ext(External_IdP, "External IdP", "Provedor de identidade externo")
    System_Ext(HSM_Provider, "HSM Provider", "Hardware Security Module")
    System_Ext(SIEM, "SIEM", "Security Information and Event Management")

    Rel(End_User, main_system, "Usa", "HTTPS")
    Rel(Security_Admin, main_system, "Gerencia", "HTTPS")
    Rel(main_system, External_IdP, "Integra com", "HTTPS/mTLS")
    Rel(main_system, HSM_Provider, "Reporta para", "HTTPS")
    Rel(main_system, SIEM, "Comunica com", "HTTPS")

    UpdateElementStyle(main_system, $fontColor="#FFFFFF", $bgColor="#4285F4", $borderColor="#1A73E8")
    UpdateLayoutConfig($c4ShapeInRow="3", $c4BoundaryInRow="1")